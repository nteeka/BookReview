@model PagedList.IPagedList<KK_BookStore.BaiViet>
@using PagedList.Mvc;
@{
    ViewBag.Title = "danhSachBaiVietChuaDuyet";
    Layout = "~/Views/Shared/Admin.cshtml";
}

<div class="container">

    <div class="card">

        <div class="card-body">
            <a href="@Url.Action("danhSachBaiVietBiTuChoi", "Admin")" class="btn btn-danger waves-effect waves-light">Post's deny</a>
            <a href="@Url.Action("danhSachDaGhim", "Admin")" class="btn btn-primary waves-effect waves-light"><i class="fa fa-plus"></i>Pinned Post</a>
            <a href="@Url.Action("danhSachBaiVietDaDuyet", "Admin")" class="btn btn-primary waves-effect waves-light">Public Post</a>

            <div class="row">
                <div class="col-xl-12">
                    <div class="card">

                        <div class="card-body">
                            <div class="row align-items-center">
                                <div class="table-responsive px-3">
                                    <table class="table table-striped align-middle table-nowrap">
                                        <tbody>
                                            @if (Model.Count() == 0)
                                            {


                                                <tr>
                                                    <td>None post</td>
                                                </tr>
                                            }
                                            else
                                            {
                                                foreach (var item in Model)
                                                {
                                                    if (item.Pinned == true)
                                                    {
                                                        <tr style="background-color:chartreuse">
                                                            <td>
                                                                <div class="avatar-lg me-4">
                                                                    <img src="@item.AnhBia" width="380" height="380" class="img-fluid rounded" alt="">
                                                                </div>
                                                            </td>

                                                            <td>
                                                                <div>
                                                                    @if (item.TenBaiViet.Length < 30)
                                                                    {
                                                                        <h5 class="font-size-18"><a href="ecommerce-product-detail.html" class="text-dark">@item.TenBaiViet</a></h5>

                                                                    }
                                                                    else
                                                                    {
                                                                        <h5 class="font-size-18"><a href="ecommerce-product-detail.html" class="text-dark">@item.TenBaiViet.Substring(0, 30)...</a></h5>

                                                                    }
                                                                    <p class="text-muted mb-0 mt-2 pt-2">

                                                                        @item.TheLoai.TenTL
                                                                    </p>
                                                                </div>
                                                            </td>



                                                            <td style="width: 180px;">

                                                                <ul class="list-inline mb-0 text-muted product-color">

                                                                    <i style="color:goldenrod" class="mdi mdi-circle font-size-16 text-yellow">Waiting</i>





                                                                </ul>
                                                            </td>

                                                            @*<td style="width: 220px;">
                                                                    <h3 class="mb-0 font-size-20"><span class="text-muted me-2"><del class="font-size-16 fw-normal">$500</del></span><b>$450</b></h3>
                                                                </td>*@

                                                            <td>
                                                                <a href="@Url.Action("xemTruocBaiViet","Admin",new {@id = item.MaBaiViet})" class="btn btn-primary waves-effect waves-light"><i class="fa fa-eye"></i>Check post</a>
                                                            </td>

                                                            <td>
                                                                <div class="dropdown float-end">
                                                                    <a class="text-muted dropdown-toggle font-size-20" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true">
                                                                        <i class="bx bx-dots-horizontal-rounded"></i>
                                                                    </a>
                                                                    <div class="dropdown-menu dropdown-menu-end">
                                                                        @if (item.Pinned == true)
                                                                        {
                                                                            <a class="dropdown-item" href="@Url.Action("ghimBaiViet", "Admin", new { @id= item.MaBaiViet,@strURL = Request.Url.ToString().Trim()})">Unpin this post</a>

                                                                        }
                                                                        else
                                                                        {
                                                                            <a class="dropdown-item" href="@Url.Action("ghimBaiViet", "Admin", new { @id= item.MaBaiViet,@strURL = Request.Url.ToString().Trim()})">Pin this post</a>

                                                                        }
                                                                        <a class="dropdown-item" href="@Url.Action("trangCaNhan", "NguoiDung", new { @name = item.TaiKhoan })">Check Author</a>
                                                                        <a class="dropdown-item" href="@Url.Action("duyetBaiViet","Admin",new {@id = item.MaBaiViet, @strURL = Request.Url.ToString()})">Accept</a>
                                                                        <a class="dropdown-item" href="@Url.Action("tuChoiBaiViet","Admin",new {@id = item.MaBaiViet, @strURL = Request.Url.ToString()})">Deny</a>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    }
                                                    else
                                                    {
                                                        <tr>
                                                            <td>
                                                                <div class="avatar-lg me-4">
                                                                    <img src="@item.AnhBia" width="380" height="380" class="img-fluid rounded" alt="">
                                                                </div>
                                                            </td>

                                                            <td>
                                                                <div>
                                                                    @if (item.TenBaiViet.Length < 30)
                                                                    {
                                                                        <h5 class="font-size-18"><a href="ecommerce-product-detail.html" class="text-dark">@item.TenBaiViet</a></h5>

                                                                    }
                                                                    else
                                                                    {
                                                                        <h5 class="font-size-18"><a href="ecommerce-product-detail.html" class="text-dark">@item.TenBaiViet.Substring(0, 30)...</a></h5>

                                                                    }
                                                                    <p class="text-muted mb-0 mt-2 pt-2">

                                                                        @item.TheLoai.TenTL
                                                                    </p>
                                                                </div>
                                                            </td>



                                                            <td style="width: 180px;">

                                                                <ul class="list-inline mb-0 text-muted product-color">

                                                                    <i style="color:goldenrod" class="mdi mdi-circle font-size-16 text-yellow">Waiting</i>





                                                                </ul>
                                                            </td>

                                                            @*<td style="width: 220px;">
                                                                    <h3 class="mb-0 font-size-20"><span class="text-muted me-2"><del class="font-size-16 fw-normal">$500</del></span><b>$450</b></h3>
                                                                </td>*@

                                                            <td>
                                                                <a href="@Url.Action("xemTruocBaiViet","Admin",new {@id = item.MaBaiViet})" class="btn btn-primary waves-effect waves-light"><i class="fa fa-eye"></i>Check post</a>
                                                            </td>

                                                            <td>
                                                                <div class="dropdown float-end">
                                                                    <a class="text-muted dropdown-toggle font-size-20" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true">
                                                                        <i class="bx bx-dots-horizontal-rounded"></i>
                                                                    </a>
                                                                    <div class="dropdown-menu dropdown-menu-end">
                                                                        @if (item.Pinned == true)
                                                                        {
                                                                            <a class="dropdown-item" href="@Url.Action("ghimBaiViet", "Admin", new { @id= item.MaBaiViet,@strURL = Request.Url.ToString().Trim()})">Unpin this post</a>

                                                                        }
                                                                        else
                                                                        {
                                                                            <a class="dropdown-item" href="@Url.Action("ghimBaiViet", "Admin", new { @id= item.MaBaiViet,@strURL = Request.Url.ToString().Trim()})">Pin this post</a>

                                                                        }
                                                                        <a class="dropdown-item" href="@Url.Action("trangCaNhan", "NguoiDung", new { @name = item.TaiKhoan })">Check Author</a>
                                                                        <a class="dropdown-item" href="@Url.Action("duyetBaiViet","Admin",new {@id = item.MaBaiViet, @strURL = Request.Url.ToString()})">Accept</a>
                                                                        <a class="dropdown-item" href="@Url.Action("tuChoiBaiViet","Admin",new {@id = item.MaBaiViet, @strURL = Request.Url.ToString()})">Deny</a>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    }
                                                }

                                            }





                                        </tbody>
                                    </table>
                                    <div>
                                        Trang @(Model.PageCount < Model.PageNumber ? 0 : Model.PageNumber) /
                                        @Model.PageCount
                                    </div>
                                    <div class="MenuTrang">
                                        @Html.PagedListPager(Model, page => Url.Action("danhSachBaiVietChuaDuyet", new
                                        {
                                            page = page,

                                        }))
                                    </div>
                                    <style>
                                        .pagination {
                                            display: flex;
                                            justify-content: center;
                                            list-style: none;
                                            padding: 0;
                                        }

                                            .pagination li {
                                                margin: 0 5px;
                                            }

                                            .pagination a {
                                                text-decoration: none;
                                                padding: 5px 10px;
                                                background-color: #007BFF;
                                                color: #fff;
                                                border-radius: 5px;
                                                transition: background-color 0.3s ease;
                                            }

                                                .pagination a:hover {
                                                    background-color: #0056b3;
                                                }

                                            .pagination .disabled {
                                                pointer-events: none;
                                                opacity: 0.5;
                                            }
                                    </style>
                                    <script>
                                        // Get all rows in the table
                                        const tableRows = document.querySelectorAll('#myTable tbody tr');

                                        // Add a click event listener to each row
                                        tableRows.forEach(row => {
                                            row.addEventListener('click', () => {
                                                // Get the value of the 'data-href' attribute
                                                const link = row.getAttribute('data-href');

                                                // Navigate to the link
                                                window.location.href = link;
                                            });
                                        });
                                    </script>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script>
    $(document).ready(function () {
        var maxLength = 100;
        $(".show-read-more").each(function () {
            var myStr = $(this).text();
            if ($.trim(myStr).length > maxLength) {
                var newStr = myStr.substring(0, maxLength);
                var removedStr = myStr.substring(maxLength, $.trim(myStr).length);
                $(this).empty().html(newStr);

                $(this).append(' <a href="javascript:void(0);" class="read-more">đọc tiếp...</a>');

                $(this).append('<span class="more-text">' + removedStr +
                    '</span>');
            }
        });
        $(".read-more").click(function () {
            $(this).siblings(".more-text").contents().unwrap(); $(this).remove();
        });
    });
</script>
<style>
    .show-read-more .more-text {
        display: none;
    }
</style>
